# X1_checker 使用方法

## 工具简介

X1_checker 是一个静态应用安全测试(SAST)工具，用于分析代码中的潜在安全漏洞。该工具支持多种编程语言，可以根据自定义规则对项目代码进行全面扫描。

## 基本使用方法

### 下载规则文件

**请先下载X1_checker所需的规则文件 config_rule.yml**

目前仅编写 敏感信息、ASPX和PHP的审计规则, 上传敏感信息和PHP审计规则, 

个人编写不一定完善, 欢迎大家提交审计规则, 采纳者将赠送AI验证器使用期|权.


### 基本扫描命令

```
python X1_checker.py -p [项目路径] -n [项目名称]
```

### 示例

```
python X1_checker.py -p /path/to/your/project -n MyProject
```

## 参数详解

### 核心参数

| 参数 | 全称 | 说明 |
|-----|-----|-----|
| `-p` | `--project-path` | 需要扫描的代码文件或目录路径 |
| `-n` | `--project-name` | 项目名称 |
| `-r` | `--rules-file` | 规则文件路径，默认为`config_rules.yml` |
| `-o` | `--output` | 自定义输出文件路径 |

### 性能优化参数

| 参数 | 全称 | 说明 |
|-----|-----|-----|
| `-w` | `--workers` | 线程数，默认为CPU核心数 |
| `-s` | `--save-cache` | 缓存分析结果，默认为True |
| `-k` | `--chunk-mode` | 分块读取文件，适用于大文件，默认为False |
| `-l` | `--limit-size` | 限制检查文件大小，单位为字节 |

### 过滤参数

| 参数 | 全称 | 说明 |
|-----|-----|-----|
| `-E` | `--exclude-keys` | 扫描排除路径关键字 |
| `-e` | `--exclude-ext` | 扫描排除文件后缀 |
| `-b` | `--black-key` | 扫描排除内容关键字，支持简单的`||`和`&&`语法 |
| `-L` | `--filter-lang` | 仅扫描指定语言的规则（例如：ANY PHP JAVA） |
| `-R` | `--filter-risk` | 仅扫描指定风险等级的规则（例如：HIGH MEDIUM LOW） |
| `-N` | `--filter-vuln` | 仅扫描指定名称的规则（例如："Cloud Key"） |

### 高级分析参数

| 参数 | 全称 | 说明 |
|-----|-----|-----|
| `-P` | `--parsed-file` | 项目代码的语法解析结果文件 |
| `-C` | `--call-parser` | 自动进行代码解析，默认为False |
| `-f` | `--import-filter` | 分析时被调用方法启用导入信息过滤，默认为False |

## 优化使用方案

### 扫描大型项目

对于大型项目，推荐使用以下参数组合：

```
python X1_checker.py -p [项目路径] -n [项目名称] -w 8 -k -s -E node_modules vendor -l 10485760
```

- `-w 8`: 使用8个工作线程（根据服务器性能调整）
- `-k`: 启用分块模式，减少内存占用
- `-s`: 缓存分析结果，加速重复扫描
- `-E node_modules vendor`: 排除第三方库目录
- `-l 10485760`: 限制扫描文件大小为10MB

### 针对特定风险的快速扫描

只扫描高风险漏洞：

```
python X1_checker.py -p [项目路径] -n [项目名称] -R HIGH
```

### 针对特定编程语言

只扫描Java和PHP代码：

```
python X1_checker.py -p [项目路径] -n [项目名称] -L JAVA PHP
```

### 排除特定文件类型

增加额外的排除文件类型：

```
python X1_checker.py -p [项目路径] -n [项目名称] -e .min.js .lock .md
```

## 高级用法

### 使用代码解析提高准确性

```
python X1_checker.py -p [项目路径] -n [项目名称] -C -f
```

- `-C`: 启用自动代码解析，提高检测准确性
- `-f`: 启用导入信息过滤，减少误报

### 自定义规则扫描

```
python X1_checker.py -p [项目路径] -n [项目名称] -r custom_rules.yml
```

## 最佳实践

1. **初次扫描**：首次扫描项目时，建议不使用过滤，全面了解项目的安全状况
   ```
   python X1_checker.py -p [项目路径] -n [项目名称] -s
   ```

2. **定期全面扫描**：每周或每月进行一次全面扫描
   ```
   python X1_checker.py -p [项目路径] -n [项目名称] -s -o weekly_scan_$(date +%Y%m%d).json
   ```

3. **代码提交前扫描**：在代码提交前进行针对性扫描，关注高风险漏洞
   ```
   python X1_checker.py -p [项目路径] -n [项目名称] -R HIGH MEDIUM
   ```

4. **CI/CD流水线集成**：在持续集成流程中添加安全扫描
   ```
   python X1_checker.py -p [项目路径] -n [项目名称] -w $(nproc) -E vendor node_modules -f
   ```

## 常见问题解决

1. **扫描速度慢**：增加工作线程数 `-w`，启用缓存 `-s`，排除不必要的目录 `-E`
2. **内存占用高**：启用分块模式 `-k`，限制文件大小 `-l`
3. **误报过多**：使用 `-C -f` 启用代码解析和导入过滤，使用 `-b` 排除特定内容

## 总结

X1_checker是一个强大的静态应用安全测试工具，通过合理配置参数，可以实现高效、准确的代码安全扫描。根据项目规模和扫描需求，选择合适的参数组合，可以显著提高扫描效率和结果准确性。
